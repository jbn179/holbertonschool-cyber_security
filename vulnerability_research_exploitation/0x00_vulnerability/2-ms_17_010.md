# Task 2: Research the MS17-010 Vulnerability

## CVE Information

### 1. What is the CVE ID for the vulnerability?

**CVE ID:** CVE-2017-0144

**Also Known As:** MS17-010, "EternalBlue"

---

## Vulnerability Details

### 2. Provide a detailed description of the vulnerability

**Description:**

CVE-2017-0144 is a critical remote code execution vulnerability in Microsoft's implementation of the Server Message Block version 1 (SMBv1) protocol. This vulnerability allows remote attackers to execute arbitrary code on the target system via specially crafted packets sent to an SMBv1 server.

**Technical Details:**

The vulnerability exists in the way that the Microsoft Server Message Block 1.0 (SMBv1) server handles certain requests. An attacker who successfully exploited this vulnerability could gain the ability to execute code on the target server.

**Affected Systems:**
- Windows Vista SP2
- Windows 7 SP1
- Windows 8.1
- Windows Server 2008 SP2 and R2 SP1
- Windows Server 2012 (Gold and R2)
- Windows RT 8.1
- Windows 10 (versions 1507, 1511, 1607)
- Windows Server 2016

**Attack Vector:**

The attacker sends specially crafted messages to a Microsoft Server Message Block 1.0 (SMBv1) server, typically over TCP port 445. No user interaction is required for exploitation.

**Publication Date:** March 16, 2017

**Last Modified:** October 21, 2025

---

## Severity Assessment

### 3. What is the CVSS score for this vulnerability?

**CVSS v3.1 Score:** 8.8 (HIGH)

**Vector String:** `AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H`

**Breakdown:**
- **Attack Vector (AV:N):** Network - Can be exploited remotely
- **Attack Complexity (AC:L):** Low - No special conditions required
- **Privileges Required (PR:L):** Low - Requires limited privileges
- **User Interaction (UI:N):** None - No user interaction needed
- **Scope (S:U):** Unchanged
- **Confidentiality Impact (C:H):** High
- **Integrity Impact (I:H):** High
- **Availability Impact (A:H):** High

**CVSS v2.0 Score:** 9.3 (HIGH)

**Vector String:** `AV:N/AC:M/Au:N/C:C/I:C/A:C`

---

## Impact Analysis

### 4. What are the potential impacts of exploiting this vulnerability?

**Critical Impacts:**

1. **Remote Code Execution (RCE)**
   - Attackers can execute arbitrary code with SYSTEM-level privileges
   - Complete control over the compromised system
   - No user interaction required

2. **Confidentiality Impact: HIGH**
   - Unauthorized access to sensitive files and data
   - Ability to read any file on the system
   - Access to credentials and personal information
   - Exfiltration of corporate data

3. **Integrity Impact: HIGH**
   - Modification or deletion of files
   - Installation of malware, backdoors, or ransomware
   - System configuration changes
   - Tampering with logs to hide tracks

4. **Availability Impact: HIGH**
   - System crashes and denial of service
   - Ransomware deployment (WannaCry example)
   - Service disruption
   - Complete system compromise

**Real-World Exploitation:**

This vulnerability was notably exploited by:
- **WannaCry ransomware** (May 2017) - Affected over 200,000 computers in 150 countries
- **NotPetya malware** (June 2017) - Caused billions in damages globally
- Various APT groups and cybercriminals

**Network Propagation:**

The vulnerability allows for worm-like propagation across networks:
- Self-replicating malware can spread automatically
- Lateral movement within corporate networks
- Rapid infection of multiple systems

---

## Mitigation and Remediation

### 5. Are there any known mitigations or patches available for this vulnerability?

**Yes, multiple mitigations and patches are available:**

### **Primary Mitigation: Apply Security Patches**

**Microsoft Security Bulletin:** MS17-010

**Patch Availability:**
- Released: March 14, 2017
- Available for all affected Windows versions
- Even released patches for end-of-life systems (Windows XP, Windows Server 2003) due to severity

**Update Installation:**
- Windows Update
- Microsoft Update Catalog
- WSUS (Windows Server Update Services)

### **Additional Mitigations:**

1. **Disable SMBv1 Protocol**
   ```powershell
   # PowerShell command to disable SMBv1
   Disable-WindowsOptionalFeature -Online -FeatureName SMB1Protocol
   ```
   - SMBv1 is outdated and insecure
   - Modern Windows versions use SMBv2/SMBv3

2. **Network-Level Protections**
   - Block TCP port 445 at the firewall (external traffic)
   - Implement network segmentation
   - Use intrusion detection/prevention systems (IDS/IPS)
   - Monitor SMB traffic for anomalies

3. **CISA Directive**
   - Listed in CISA's Known Exploited Vulnerabilities Catalog
   - Required action: Apply updates per vendor instructions
   - Compliance deadline: August 10, 2022 (per CISA BOD 22-01)

4. **Best Practices**
   - Keep all systems updated with latest security patches
   - Implement principle of least privilege
   - Use network segmentation to limit lateral movement
   - Deploy endpoint detection and response (EDR) solutions
   - Regular vulnerability scanning
   - Disable unnecessary services and protocols

### **Detection Methods:**

- Use vulnerability scanners (Nessus, OpenVAS, Nmap NSE scripts)
- Microsoft's SMBv1 auditing tools
- Network traffic analysis for exploitation attempts

### **Verification:**

Check if your system is patched:
```bash
# Using Nmap NSE script
nmap --script smb-vuln-ms17-010 -p445 <target_ip>
```

---

## References

- **NVD Entry:** https://nvd.nist.gov/vuln/detail/CVE-2017-0144
- **Microsoft Security Bulletin:** MS17-010
- **CISA Known Exploited Vulnerabilities:** https://www.cisa.gov/known-exploited-vulnerabilities-catalog
- **CVE Details:** CVE-2017-0144

---

## Summary

CVE-2017-0144 (MS17-010 / EternalBlue) is one of the most critical vulnerabilities in recent history, with a CVSS score of 8.8. It allows remote code execution on Windows systems through the SMBv1 protocol without user interaction. The vulnerability was exploited by widespread ransomware attacks like WannaCry and NotPetya, causing billions in damages worldwide.

**Critical actions:**
- Apply MS17-010 security patches immediately
- Disable SMBv1 protocol
- Block TCP port 445 from external networks
- Implement network segmentation and monitoring

This vulnerability demonstrates the importance of timely patching and disabling legacy protocols.
